
<template name="post">
  {{#if post}}
  {{#with post}}
  <div class="row-fluid">
    <div class="span9">            
      {{#each tree}}
      {{> postLayout }}
      {{/each}}
    </div>
    <div class="span3">
      {{> about }}
    </div>
  </div>
  {{/with}}
  {{/if}}
</template>

<template name="tags">
  <ul class="tags inline">
    {{#each tags}}
    {{#if this}}
    <li>
      <div class="input-append pull-right">
	<button class="tag btn btn-mini btn-link" href="/tag/{{this}}">{{this}}</button>
      </div>
    </li>
    {{/if}}
    {{/each}}
  </ul>
</template>

<template name="postLayout">
  <div class="post depth{{depthIfThreaded}} {{_id}}">
    <div class="postbody">
      <div class="pull-right">
	{{> tags}}
      </div>
      <div class="fullbody">
	{{postbody}}
      </div>
    </div>
    <span class="footer">
      {{#if title}}
      <a href="/post/{{_id}}/{{url_slug}}">{{abbrTitle}}</a>
      {{/if}}
      posted by
      <a href="/directory/{{owner}}/history" class="user">{{postuser}}</a>
      <abbr class="timeago" title="{{posted}}">{{timestamp}}</abbr>  
      | score: 
      {{#if currentUser}}
      <a href="#" class="up"><i class="icon-thumbs-up{{#if myVoteIs "up"}} icon-filled{{/if}}" /></a>
      {{/if}}
      {{score}}
      {{#if currentUser}}
      <a href="#" class="down"><i class="icon-thumbs-down{{#if myVoteIs "down"}} icon-filled{{/if}}" /></a>
      {{/if}}


      {{#if showReplyCount}}
      | <a href="/post/{{_id}}/{{url_slug}}">read {{commentCount}} replies</a>
      {{/if}}

      {{#if isActive}}
      <button class="reply btn btn-mini" data-toggle="button">reply</button>
      {{/if}}
      {{#if currentUser}}
      {{#if inEditWindow}}
      <button type="button" class="edit btn btn-mini" data-toggle="button">edit for <span class="remaining">{{editTimeRemaining}}</span></button>
      {{/if}}
      {{/if}}

      {{#if parent}}
      <button class="parent btn btn-mini">parent</button>
      {{/if}}
      
      {{#if showSubThread}}
      <a class="btn btn-mini" href="/post/{{_id}}/{{url_slug}}">sub-thread</a>
      {{/if}}

      {{#if currentUser.is_admin}}
      <div class="btn-group state" data-toggle="buttons-radio">
	<button type="button" class="btn btn-mini {{maybeState "active"}}">active</button>
	<button type="button" class="btn btn-mini {{maybeState "closed"}}">closed</button>
	<button type="button" class="btn btn-mini{{maybeState "hidden"}}">hidden</button>
      </div>
      <button type="button" class="admin-edit btn btn-mini" data-toggle="button">edit</span></button>
      <button class="remove btn btn-mini" data-toggle="button">remove</button>
      {{/if}}
    </span>
  </div>
</template>

<template name="about">
  <div>
    <p>
      <a href="/"><em>Weekday Filler</em></a> is a weblog heavily
      influenced by <a href="http://metafilter.com">MetaFilter</a> with a dash
      of <a href="http://reddit.com">reddit</a>.
    </p>

    <p>
      Please <button class="post btn btn-mini" data-toggle="button">post</button> something,
      <a href="/tag/wefi-feature">suggest
	features</a>, <a href="/tag/wefi-bug">report bugs</a>,
      or <a href="/tag/wefi-meta">read more
	about</a> <em>WeFi</em>.
    </p>

    <p>
      Why bother? It's an attempt
      by <a href="/directory/4c2d4bfc-7aa5-496d-9437-b462f2fa0cc6/history">fred</a> to learn
      the <a href="http://meteor.com">Meteor framework</a>.
      <em>Weekday Filler</em> updates in real-time,
      without page
      refreshes. It's <a href="http://www.meteor.com/screencast">magic</a>.
    </p>
    
    <p>This project was also inspired by the
      recent <a href="http://metatalk.metafilter.com/22319/MeFi-is-adding-titles">clusterfuck
	over at MeFi</a> that erupted following the rollout of a
      seemingly innocuous feature. <em>Weekday Filler</em>
      aims to be fully open and responsive in its development.
    </p>
    
  </div>
</template>

<template name="postlist">
  <div class="row-fluid">
    <div class="span9">
      <div class="row-fluid">
	<div class="span6 offset1">
	  <ul class="breadcrumb">
	    <li>Showing posts with tags: </li>
	    {{#each current_tags}}
	    <li><a href="/tag/{{this}}">{{this}}</a></li>
	    {{/each}}
	  </ul>
	</div>
	<div class="span5">
	  {{{pagination}}}
	</div>
      </div>
      {{#each list}}
      {{> postLayout }}
      {{/each}}
    </div>
    <div class="span3">
      {{> about }}
    </div>
  </div>
</template>

<template name="postit">
  {{#if showPostit}}
  <div id="postit" class="depth1 modal">
    <div class="modal-body">
      {{#if error}}
      <div class="alert alert-error">{{error}}</div>
      {{/if}}
      <div class="row-fluid">
	<div class="span12">
	  <ul class="nav nav-tabs hide" id="myTab">
	    <li class="active"><a href="#home">Home</a></li>
	    <li><a href="#profile">Profile</a></li>
	  </ul>
	  
	  <div class="tab-content">
	    <div class="tab-pane active" id="home">
	      <textarea class="body" name="body" style="width: 95%;" rows="6" placeholder="Text, Markdown, or HTML goes here ...">{{body}}</textarea>
	    </div>
	    <div class="tab-pane" id="profile">
	      <div class="preview"></div>
	    </div>
	  </div>
	</div>
      </div>
      <div class="row-fluid">
	<div class="span1">
	  <label class="pull-right">Tags</label>
	</div>
	<div class="span11">
	  <input type="text" name="tags" class="tags span12" value="{{tags}}"/>
	</div>
      </div>
      <div id="help" class="row-fluid collapse">
	<div class="span12">
	  <ul>
	    <li>
	      <a target="_blank" href="http://stackoverflow.com/editing-help">Markdown tutorial</a>
	      (external link)
	    </li>
	    <li>Allowed HTML tags: 
	      <code>
		&lt;a&gt; 
		&lt;b&gt;
		&lt;blockquote&gt;
		&lt;code&gt;
		&lt;del&gt;
		&lt;dd&gt;
		&lt;dl&gt;
		&lt;dt&gt;
		&lt;em&gt;
		&lt;h1&gt;
		&lt;h2&gt;
		&lt;h3&gt;
		&lt;i&gt;
		&lt;kbd&gt;
		&lt;li&gt;
		&lt;ol&gt;
		&lt;p&gt;
		&lt;pre&gt;
		&lt;s&gt;
		&lt;sup&gt;
		&lt;sub&gt;
		&lt;strong&gt;
		&lt;strike&gt;
		&lt;ul&gt;
		&lt;br/&gt;
		&lt;hr/&gt;
	      </code>
	    </li>
	  </ul>
	</div>
      </div>
      <div class="modal-footer">
	<button type="button" class="btn" data-toggle="collapse" data-target="#help">Markdown / HTML help</button>
	<button type="button" class="btn preview" data-toggle="button">Preview</button>
	<button type="button" class="btn btn-primary save">Save</button>
	<button type="button" class="btn cancel btn-danger">Cancel</button>
      </div>
    </div>
  </div>
  {{/if}}
</template>

<template name="all_tags">
  <ul>
    {{#each tags}}
    <li><a href="/tag/{{this}}">{{this}}</a></li>
    {{/each}}
  </ul>
</template>
