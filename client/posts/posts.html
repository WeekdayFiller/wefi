
<template name="post">
  {{#if post}}
  {{> comments}}
  {{/if}}
</template>

<template name="postLayout">
  <div class="post depth{{depth}}">
    <a name="{{_id}}" />
  {{postbody}}
  <span class="footer">
    posted by
    <a href="" class="user">{{postuser}}</a>
    at {{timestamp}} 
    {{#if parent}}
    <a href="#{{parent}}" class="btn btn-mini">goto parent</a>
    {{/if}}
    {{#if isDifferentPost}}
    {{#if isRoot}}
    <a href="/post/{{_id}}" class="btn btn-mini">view {{commentCount}} replies</a>
    {{else}}
    {{#if hasChildren}}
    <a href="/post/{{_id}}" class="btn btn-mini">view sub-thread</a>
    {{/if}}
    {{/if}}
    {{/if}}
    <a href="#" class="reply btn btn-mini" data-toggle="button">reply</a>
    <a href="#" class="up"><i class="icon-thumbs-up" /></a>
    <a href="#" class="down"><i class="icon-thumbs-down" /></a>
    {{#if currentUser.is_admin}}
    <button class="remove btn btn-mini" data-toggle="button">remove</button>
    {{/if}}
  </span>
  <br/>
  <br/>
  </div>
</template>

<template name="comments">
  <div>            
    {{#each tree}}
    {{> postLayout }}
    {{/each}}
  </div>
</template>

<template name="postlist">
  {{{pagination}}}
  <div>            
    {{#each list}}
    {{> postLayout }}
    {{/each}}
  </div>
  {{{pagination}}}
</template>

<template name="postit">
  <div id="postit" class="depth1 modal hide">
    <div class="modal-body">
      {{#if error}}
      <div class="alert alert-error">{{error}}</div>
      {{/if}}
      <div class="row-fluid">
	<div class="span12">
	  <ul class="nav nav-tabs hide" id="myTab">
	    <li class="active"><a href="#home">Home</a></li>
	    <li><a href="#profile">Profile</a></li>
	  </ul>
	  
	  <div class="tab-content">
	    <div class="tab-pane active" id="home">
	      <div id="wmd-button-bar"></div>
	      <textarea class="body" style="width: 95%;" rows="6" id="wmd-input" />
	    </div>
	    <div class="tab-pane" id="profile">
	      <div id="wmd-preview" class="wmd-preview"></div>
	    </div>
	  </div>
	</div>
      </div>
      <div class="row-fluid">
	<div class="span12">
	  <label>Tags</label>
	  <input type="text" class="tags span12" value="{{tags}}"/>
	</div>
      </div>
      <div class="modal-footer">
	<button type="button" class="btn preview" data-toggle="button">Preview</button>
	<button type="button" class="btn btn-primary save">Post</button>
	<button type="button" class="btn cancel btn-danger">Cancel</button>
      </div>
    </div>
  </div>
</template>
